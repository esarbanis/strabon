PREFIX noa: <http://teleios.di.uoa.gr/ontologies/noaOntology.owl#> 
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#> 
PREFIX strdf: <http://strdf.di.uoa.gr/ontology#> 
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> 
PREFIX gag: <http://teleios.di.uoa.gr/ontologies/gagKallikratis.rdf#>

SELECT ?h  (strdf:transform(?hGeo, <http://www.opengis.net/def/crs/EPSG/0/4326>) AS ?geo) ?conf ?muni
WHERE { 
?h   noa:hasGeometry ?hGeo ;
     noa:hasAcquisitionTime ?hAcquisitionTime ; 
     noa:producedFromProcessingChain "PROCESSING_CHAIN"^^xsd:string ; 
     noa:isDerivedFromSensor "SENSOR2"^^xsd:string ;
     noa:hasConfidence ?conf ;
     gag:hasMunicipality ?muni .
     FILTER("2007-08-25T15:15:00"^^xsd:dateTime <= ?hAcquisitionTime && ?hAcquisitionTime < "2007-08-25T23:15:00"^^xsd:dateTime ) .
     OPTIONAL {?h noa:isDiscarded ?disc }.
     FILTER (!bound(?disc)) .
}
