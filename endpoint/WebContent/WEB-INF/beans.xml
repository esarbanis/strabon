<?xml version="1.0" encoding="UTF-8"?>
<beans  xmlns="http://www.springframework.org/schema/beans"
		xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    	xsi:schemaLocation="http://www.springframework.org/schema/beans 
    						http://www.springframework.org/schema/beans/spring-beans-2.5.xsd"
		xmlns:jaxws="http://cxf.apache.org/jaxws"
		jaxws:schemaLocation="http://cxf.apache.org/jaxws http://cxf.apache.org/schemas/jaxws.xsd">

<!--
    <import resource="classpath:META-INF/cxf/cxf.xml" />
    <import resource="classpath:META-INF/cxf/cxf-extension-soap.xml" />
    <import resource="classpath:META-INF/cxf/cxf-servlet.xml" />
-->
    <bean
        id="strabonBean"
        class="eu.earthobservatory.org.StrabonEndpoint.StrabonBeanWrapper"
        destroy-method="destroy" >

        <constructor-arg type="java.lang.String" >
            <!-- Database name -->
            <value>endpoint</value>
        </constructor-arg>

        <constructor-arg type="java.lang.String" >
            <!-- Username -->
            <value>postgres</value>
        </constructor-arg>

        <constructor-arg type="java.lang.String" >
            <!-- Password -->
	    <value>postgres</value>
        </constructor-arg>

        <constructor-arg type="int" >
            <!-- Port -->
            <value>5432</value>
        </constructor-arg>

        <constructor-arg type="java.lang.String" >
            <!-- Database server -->
            <value>localhost</value>
        </constructor-arg>

        <constructor-arg type="boolean" >
            <!-- Check for locks and remove them (in case of a crash) -->
            <value>true</value>
        </constructor-arg>

        <constructor-arg type="java.lang.String" >
            <!-- Database Backend (either "postgis" or "monetdb") -->
            <value>postgis</value>
        </constructor-arg>
        
         <constructor-arg>
             <list>
	             <list>
	                 <!-- Bean -->
	                <value>Query</value> 
	                <!-- Format -->
	                <value>HTML</value>   
	                <!-- Label -->
	                <value>Query 1: Discover raw data and products</value> 
	                <!-- Statement -->
	                <value><![CDATA[# Discovering raw data and products
PREFIX noa: <http://teleios.di.uoa.gr/ontologies/noaOntology.owl#>
PREFIX clc: <http://teleios.di.uoa.gr/ontologies/clcOntology.owl#>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX strdf: <http://strdf.di.uoa.gr/ontology#>
PREFIX teleios: <http://teleios.di.uoa.gr/ontologies/noaOntology.owl#>
PREFIX gag: <http://www.semanticweb.org/ontologies/2011/gagKallikratis.rdf#>
PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#>
PREFIX georss: <http://www.georss.org/georss/>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX lgdo: <http://linkedgeodata.org/ontology/>
PREFIX gn: <http://www.geonames.org/ontology#>

SELECT ?filename
WHERE {?file rdf:type noa:ShpFile ;
	         noa:hasFilename ?filename ;
	         noa:hasAcquisitionTime ?sensingTime .
	 FILTER( str(?sensingTime) >= "2007-08-26T12:00:00" ) .
	 FILTER( str(?sensingTime) <= "2007-08-26T12:30:00" ) .
	 ?file noa:isDerivedFromSensor ?sensor .
	 FILTER( str(?sensor) = "MSG2" ) .
	 ?file noa:producedFromProcessingChain ?chain .
	 FILTER( str(?chain) = "StaticThresholds" ) . 
}]]></value>
<value>Find all shapefiles derived from sensor MSG2 between [2007-08-26T12:00:00,2007-08-26T12:30:00], using dynamic thresholds.</value>
	            </list>
	            <list>
	                <!-- Bean -->
	                <value>Query</value> 
	                <!-- Format -->
	                <value>KMZMAP</value>
	                <!-- Label -->
	                <value>Query 2: Discover Hotspots</value> 
	                <!-- Statement -->
	                <value><![CDATA[# Get all hotspots 
# - in Pelloponesus 
# - at 2007-08-24
PREFIX noa: <http://teleios.di.uoa.gr/ontologies/noaOntology.owl#>
PREFIX clc: <http://teleios.di.uoa.gr/ontologies/clcOntology.owl#>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX strdf: <http://strdf.di.uoa.gr/ontology#>
PREFIX teleios: <http://teleios.di.uoa.gr/ontologies/noaOntology.owl#>
PREFIX gag: <http://www.semanticweb.org/ontologies/2011/gagKallikratis.rdf#>
PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#>
PREFIX georss: <http://www.georss.org/georss/>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX lgdo: <http://linkedgeodata.org/ontology/>
PREFIX gn: <http://www.geonames.org/ontology#>

SELECT ?h ?hAcqTime ?hConfidence ?hConfirmation ?hProvider ?hSensor ?hSatellite (strdf:transform(?hGeo, <http://www.opengis.net/def/crs/EPSG/0/4326>) as ?geo) 
WHERE { ?h 	rdf:type noa:Hotspot;
			noa:hasGeometry ?hGeo;
			noa:hasAcquisitionTime ?hAcqTime;
			noa:hasConfidence ?hConfidence;
			noa:isProducedBy ?hProvider;
			noa:hasConfirmation ?hConfirmation;
			noa:isDerivedFromSensor ?hSensor;
			noa:isDerivedFromSatellite ?hSatellite ;
			noa:producedFromProcessingChain ?hChain .
	FILTER(str(?hChain) = "StaticThresholds").
	FILTER(?hAcqTime = "2007-08-24T14:45:00"^^xsd:dateTime) .
	FILTER(strdf:contains("POLYGON((21.027 38.36, 23.77 38.36, 23.77 36.05, 21.027 36.05, 21.027 38.36))"^^ strdf:WKT, ?hGeo)) . 
}]]></value>
<value>Find all hotspots in Pelloponesus derived from the dynamic thresholds processing chain at 2007-08-24T14:45:00.  </value>
	            </list>
				<list>
	                <!-- Bean -->
	                 <value>Update</value>
	                <!-- Format -->
	                <value>HTML</value>
	                <!-- Label -->
	                <value>Update A: Invalidate hotspots in sea</value> 
	                <!-- Statement -->
	                <value><![CDATA[# Delete hotspots that lie in sea
PREFIX noa: <http://teleios.di.uoa.gr/ontologies/noaOntology.owl#>
PREFIX clc: <http://teleios.di.uoa.gr/ontologies/clcOntology.owl#>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX strdf: <http://strdf.di.uoa.gr/ontology#>
PREFIX teleios: <http://teleios.di.uoa.gr/ontologies/noaOntology.owl#>
PREFIX gag: <http://www.semanticweb.org/ontologies/2011/gagKallikratis.rdf#>
PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#>
PREFIX georss: <http://www.georss.org/georss/>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX lgdo: <http://linkedgeodata.org/ontology/>
PREFIX gn: <http://www.geonames.org/ontology#>
DELETE {?h ?property ?object}
WHERE { ?h 	rdf:type noa:Hotspot;
            noa:hasAcquisitionTime ?hAcqTime;
            noa:producedFromProcessingChain ?hChain;
            noa:hasGeometry ?hGeo;
            ?property ?object.
        FILTER(str(?hChain) = "StaticThresholds").
        FILTER(strdf:contains("POLYGON((21.027 38.36, 23.77 38.36, 23.77 36.05, 21.027 36.05, 21.027 38.36))"^^ strdf:WKT, ?hGeo)).
        FILTER("2007-08-24T14:45:00"^^xsd:dateTime = ?hAcqTime).
        OPTIONAL {
            ?c rdf:type noa:Coastline;
               noa:hasGeometry ?cGeo.
            FILTER(strdf:contains("POLYGON((21.027 38.36, 23.77 38.36, 23.77 36.05, 21.027 36.05, 21.027 38.36))"^^ strdf:WKT, ?cGeo)).
            FILTER(strdf:anyInteract(?hGeo, ?cGeo)) . 
        }
        FILTER(!bound(?c)). 
}]]></value>
<value>Mark as invalid all hotspots produced by the static thresholds processing chain and are acquired at 2007-08-24T14:45:00 which are located in the sea</value>
	            </list>
	            <list>
	                <!-- Bean -->
	                <value>Update</value> 
	                <!-- Format -->
	                <value>HTML</value>
	                <!-- Label -->
	                <value>Update B: Refine hotspots in sea</value>
	                <!-- Statement -->
	                <value><![CDATA[# Refine the geometry of hotspots that partially lie in sea
PREFIX noa: <http://teleios.di.uoa.gr/ontologies/noaOntology.owl#> 
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
PREFIX strdf: <http://strdf.di.uoa.gr/ontology#> 
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> 


INSERT { ?h noa:isDiscarded "1"^^xsd:int . 
	 ?valid rdf:type noa:Hotspot ;
		noa:hasConfidence ?conf ;
	        noa:hasGeometry ?dif ;
		noa:hasAcquisitionTime "TIMESTAMP"^^xsd:dateTime ; 
	        noa:isDerivedFromSensor "SENSOR"^^xsd:string ;
		noa:hasConfirmation noa:unknown ;
	        noa:producedFromProcessingChain "PROCESSING_CHAIN"^^xsd:string ; 
		noa:isProducedBy noa:noa ;
		noa:isDerivedFromSatellite ?sat .
}
WHERE { 
  SELECT DISTINCT ?h ?hGeo (strdf:intersection(?hGeo, strdf:union(?cGeo)) AS ?dif) (BNODE() AS ?valid) ?conf ?sat
  WHERE { 
    ?h rdf:type noa:Hotspot ; 
       noa:hasAcquisitionTime ?hAcqTime ; 
       noa:producedFromProcessingChain "PROCESSING_CHAIN"^^xsd:string ; 
       noa:isDerivedFromSensor "SENSOR"^^xsd:string ;
       noa:hasGeometry ?hGeo ;
       noa:hasConfidence ?conf ;
       noa:isDerivedFromSatellite ?sat .
    FILTER("TIMESTAMP"^^xsd:dateTime = ?hAcqTime) .
    ?c rdf:type noa:Coastline ;
       noa:hasGeometry ?cGeo .
    FILTER(strdf:anyInteract(?hGeo, ?cGeo)) . 
  }
  GROUP BY ?h ?hGeo ?conf ?sat
  HAVING strdf:overlap(?hGeo, strdf:union(?cGeo))
}
]]></value>
	      <value>Refine hotspots acquired at 2007-08-24T14:45:00 removing the part that lies in the sea. </value>
	            </list>
	            <list>
	                <!-- Bean -->
	                <value>Query</value> 
	                <!-- Format -->
	                <value>KMZMAP</value>
	                <!-- Label -->
	                <value>Query 3: Discover coniferous forests</value> 
	                <!-- Statement -->
	                <value><![CDATA[#Get all coniferous forests in Peloponnese
PREFIX noa: <http://teleios.di.uoa.gr/ontologies/noaOntology.owl#>
PREFIX clc: <http://teleios.di.uoa.gr/ontologies/clcOntology.owl#>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX strdf: <http://strdf.di.uoa.gr/ontology#>
PREFIX teleios: <http://teleios.di.uoa.gr/ontologies/noaOntology.owl#>
PREFIX gag: <http://www.semanticweb.org/ontologies/2011/gagKallikratis.rdf#>
PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#>
PREFIX georss: <http://www.georss.org/georss/>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX lgdo: <http://linkedgeodata.org/ontology/>
PREFIX gn: <http://www.geonames.org/ontology#>

SELECT ?a ?aGeo
WHERE{ ?a rdf:type clc:Area;
          clc:hasLandUse ?aLandUse;
          noa:hasGeometry ?aGeo.
       ?aLandUse rdf:type ?aLandUseType.
       FILTER(?aLandUseType = clc:ConiferousForest).
       FILTER(strdf:contains("POLYGON((21.027 38.36, 23.77 38.36, 23.77 36.05, 21.027 36.05, 21.027 38.36))"^^strdf:WKT,?aGeo)). 
}]]></value>
<value>Discover all coniferous forests using the clc ontology </value>
	            </list>
	            <list>
	                <!-- Bean -->
	                <value>Query</value> 
	                <!-- Format -->
	                <value>KMZMAP</value>
	                <!-- Label -->
	                <value>Query 4: Discover primary roads</value> 
	                <!-- Statement -->
	                <value><![CDATA[# Get all municipalities of Pelloponnese
PREFIX noa: <http://teleios.di.uoa.gr/ontologies/noaOntology.owl#>
PREFIX clc: <http://teleios.di.uoa.gr/ontologies/clcOntology.owl#>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX strdf: <http://strdf.di.uoa.gr/ontology#>
PREFIX teleios: <http://teleios.di.uoa.gr/ontologies/noaOntology.owl#>
PREFIX gag: <http://www.semanticweb.org/ontologies/2011/gagKallikratis.rdf#>
PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#>
PREFIX georss: <http://www.georss.org/georss/>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX lgdo: <http://linkedgeodata.org/lontology/>
PREFIX gn: <http://www.geonames.org/ontology#>

SELECT  ?d ?dGeo
WHERE { ?d rdf:type gag:Dhmos; 
           strdf:hasGeometry ?dGeo; 
           rdfs:label ?dLabel. 
           FILTER(strdf:contains("POLYGON((21.027 38.36, 23.77 38.36, 23.77 36.05, 21.027 36.05, 21.027 38.36))"^^ strdf:WKT, ?dGeo)). 
}]]></value>
<value>Find all municipalities of Pelloponnese using kallikratis ontology </value>
	            </list>
	            <list>
	                <!-- Bean -->
	                <value>Query</value> 
	                <!-- Format -->
	                <value>KMZMAP</value>
	                <!-- Label -->
	                <value>Query 5: Get all primary roads in Pelloponnese</value> 
	                <!-- Statement -->
	                <value><![CDATA[# Get all primary roads in Pelloponnese
PREFIX noa: <http://teleios.di.uoa.gr/ontologies/noaOntology.owl#>
PREFIX clc: <http://teleios.di.uoa.gr/ontologies/clcOntology.owl#>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX strdf: <http://strdf.di.uoa.gr/ontology#>
PREFIX teleios: <http://teleios.di.uoa.gr/ontologies/noaOntology.owl#>
PREFIX gag: <http://www.semanticweb.org/ontologies/2011/gagKallikratis.rdf#>
PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#>
PREFIX georss: <http://www.georss.org/georss/>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX lgdo: <http://linkedgeodata.org/ontology/>
PREFIX gn: <http://www.geonames.org/ontology#>

SELECT  ?r ?rGeo
WHERE { ?r rdf:type ?rType ;
           noa:hasGeometry ?rGeo .
        FILTER(?rType = lgdo:Primary) .
        FILTER(strdf:contains("POLYGON((21.027 38.36, 23.77 38.36, 23.77 36.05, 21.027 36.05,21.027 38.36))"^^strdf:WKT, ?rGeo) ). 
}]]></value>
<value>Get all primary roads in Pelloponnese using the linked geodata ontology </value>
	            </list>
	            <list>
	                <!-- Bean -->
	                <value>Query</value> 
	                <!-- Format -->
	                <value>KMZMAP</value>
	                <!-- Label -->
	                <value>Query 6: Discover hotspots</value> 
	                <!-- Statement -->
	                <value><![CDATA[# Get all hotspots 
# - in Pelloponesus 
# - at 2007-08-24
PREFIX noa: <http://teleios.di.uoa.gr/ontologies/noaOntology.owl#>
PREFIX clc: <http://teleios.di.uoa.gr/ontologies/clcOntology.owl#>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX strdf: <http://strdf.di.uoa.gr/ontology#>
PREFIX teleios: <http://teleios.di.uoa.gr/ontologies/noaOntology.owl#>
PREFIX gag: <http://www.semanticweb.org/ontologies/2011/gagKallikratis.rdf#>
PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#>
PREFIX georss: <http://www.georss.org/georss/>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX lgdo: <http://linkedgeodata.org/ontology/>
PREFIX gn: <http://www.geonames.org/ontology#>

SELECT  ?h ?hAcqTime (strdf:transform(?hGeo, <http://www.opengis.net/def/crs/EPSG/0/4326>) as ?geo) 
WHERE { ?h 	rdf:type noa:Hotspot;
            noa:hasGeometry ?hGeo;
            noa:hasAcquisitionTime ?hAcqTime;
            noa:producedFromProcessingChain ?hChain .
        FILTER(str(?hChain) = "StaticThresholds").
        FILTER(?hAcqTime = "2007-08-24T14:45:00"^^xsd:dateTime) .
        FILTER(strdf:contains("POLYGON((21.027 38.36, 23.77 38.36, 23.77 36.05, 21.027 36.05, 21.027 38.36))"^^ strdf:WKT, ?hGeo)) . 
        ?a rdf:type clc:Area;
           clc:hasLandUse ?aLandUse;
           noa:hasGeometry ?aGeo.
        ?aLandUse rdf:type ?aLandUseType.
        FILTER(?aLandUseType = clc:Forest).
        FILTER(strdf:contains("POLYGON((21.027 38.36, 23.77 38.36, 23.77 36.05, 21.027 36.05, 21.027 38.36))"^^strdf:WKT,?aGeo)). 
        FILTER(strdf:overlap(?aGeo, ?hGeo)) . 
}]]></value>
<value>Find all hotspots located in Pelloponnesian forests and acquired at 2007-08-24T14:45:00 using static thresholds processing chain </value>
	            </list>
<!-- 	            <list> -->
<!-- 	                Bean -->
<!-- 	                <value>Query</value>  -->
<!-- 	                Format -->
<!-- 	                <value>KMZMAP</value> -->
<!-- 	                Label -->
<!-- 	                <value></value>  -->
<!-- 	                Statement -->
<!-- 	                <value></value> -->
<!-- 	            </list> -->
            </list>
         </constructor-arg>
    </bean>
    
    <bean id="commonBean" class="eu.earthobservatory.org.StrabonEndpoint.Common" scope="singleton"/>
</beans>
